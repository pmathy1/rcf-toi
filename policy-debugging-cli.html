<!doctype html>
<html lang="en-gb" dir="ltr">
<head>
<meta charset="utf-8" />
	<base href="https://www.arista.com/en/support/toi/eos-4-27-2f/15100-policy-debugging-cli" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="author" content="David Cronin" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="HandheldFriendly" content="true" />
	<meta name="apple-mobile-web-app-capable" content="YES" />
	<meta name="Rating" content="General" />
	<meta name="Classification" content="General" />
	<meta name="Distribution" content="Global" />
	<meta name="Audience" content="All" />
	<meta name="revisit-after" content="1 days" />
	<meta name="Author" content="Arista Networks" />
	<meta name="Publisher" content="Arista Networks" />
	<meta name="robots" content="All" />
	<meta name="description" content="This document describes a new CLI command to help debug how and why policy permits and denies paths. The aim of this CLI command is for the user to debug a route map or RCF (Routing Control Functions) function by specifying as input a prefix for which" />
	<title>Policy Debugging CLI - Arista</title>
	<link href="https://www.arista.com/en/support/toi/eos-4-27-2f/15100-policy-debugging-cli" rel="canonical" />
	<link href="/templates/arista_v2/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon" />
	<link href="/templates/arista_v2/css/bs337.min.css?v=1543082404" rel="stylesheet" />
	<link href="/templates/arista_v2/css/anH5Set.css?v=1601533343" rel="stylesheet" />
	<link href="/templates/arista_v2/css/anLayout.css?v=1676642446" rel="stylesheet" />
	<link href="/templates/arista_v2/css/anStyle.css?v=1698911251" rel="stylesheet" />
	<link href="/templates/arista_v2/css/anRespo.css?v=1698911353" rel="stylesheet" />
	<link href="/custom_ui/css/jqueryUi-1.10.4.css?v=1522948259" rel="stylesheet" />
	<script type="application/json" class="joomla-script-options new">{"csrf.token":"4aea7386b640bfc806fdba2fa7a259d8","system.paths":{"root":"","base":""}}</script>
	<script src="/media/jui/js/jquery.min.js?bce97e69c200e310a6886d3dcb964f7f"></script>
	<script src="/media/jui/js/jquery-noconflict.js?bce97e69c200e310a6886d3dcb964f7f"></script>
	<script src="/media/jui/js/jquery-migrate.min.js?bce97e69c200e310a6886d3dcb964f7f"></script>
	<script src="/media/system/js/caption.js?bce97e69c200e310a6886d3dcb964f7f"></script>
	<script src="/media/system/js/mootools-core.js?bce97e69c200e310a6886d3dcb964f7f"></script>
	<script src="/media/system/js/core.js?bce97e69c200e310a6886d3dcb964f7f"></script>
	<script src="/templates/arista_v2/js/jq331.min.js?v=1524283288"></script>
	<script src="/templates/arista_v2/js/bs337.min.js?v=1524283288"></script>
	<script src="/templates/arista_v2/js/cb164.min.js?v=1524283288"></script>
	<script src="/templates/arista_v2/js/anScript.js?v=1694698768"></script>
	<script src="/templates/arista_v2/js/anLangPrefix.js?v=1698653165"></script>
	<script src="/templates/arista_v2/js/anBrowserCheck.js?v=1582796951"></script>
	<script src="/custom_ui/js/jqueryUi-1.10.4.min.js?v=1520261210"></script>
	<script src="/templates/arista_v2/js/anSlideTabs.js?v=1524283288"></script>
	<script>
jQuery(window).on('load',  function() {
				new JCaption('img.caption');
			});
	</script>
	<script type="application/ld+json">
[{"@context":"http://schema.org/","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.arista.com/en/support/toi/eos-4-27-2f/15100-policy-debugging-cli"},"name":"Policy Debugging CLI - Arista","headline":"Policy Debugging CLI - Arista","author":{"@type":"Organization","name":"Arista Networks"},"publisher":{"@type":"Organization","name":"Arista Networks","logo":{"@type":"ImageObject","url":"https://www.arista.com/assets/images/logo/Arista_Logo.png"}},"image":"https://www.arista.com/assets/images/logo/arista_logo_blue_bg_500x280.jpg","description":"This document describes a new CLI command to help debug how and why policy permits and denies paths. The aim of this CLI command is for the user to debug a route map or RCF (Routing Control Functions) function by specifying as input a prefix for which","datePublished":"2023-07-13 08:06:24","dateModified":"2023-07-13 08:06:24"}]
	</script>
	<meta property="og:title" content="Policy Debugging CLI - Arista" />
	<meta property="og:description" content="This document describes a new CLI command to help debug how and why policy permits and denies paths. The aim of this CLI command is for the user to debug a route map or RCF (Routing Control Functions) function by specifying as input a prefix for which"/>
	<meta property="og:image" content="https://www.arista.com/assets/images/logo/arista_logo_blue_bg_500x280.jpg"/>
	<meta property="article:published_time" content="2023-07-13 08:06:24"/>
	<meta name="twitter:title" content="Policy Debugging CLI - Arista">
	<meta name="twitter:description" content="This document describes a new CLI command to help debug how and why policy permits and denies paths. The aim of this CLI command is for the user to debug a route map or RCF (Routing Control Functions) function by specifying as input a prefix for which">
	<meta name="twitter:image" content="https://www.arista.com/assets/images/logo/arista_logo_blue_bg_500x280.jpg">
	<meta property="og:type" content="Article"/>
	<meta property="og:url" content="https://www.arista.com/en/support/toi/eos-4-27-2f/15100-policy-debugging-cli"/>
	<meta property="og:site_name" content="Arista Networks"/>
	<meta property="article:author" content="Arista Networks"/>
	<meta name="twitter:card" content="summary">
	<meta name="twitter:url" content="https://www.arista.com/en/support/toi/eos-4-27-2f/15100-policy-debugging-cli">
	<meta name="twitter:site" content="@AristaNetworks">

<!--[if lt IE 9]><script src="/media/jui/js/html5.js"></script><![endif]-->
<script>
	jq = jQuery.noConflict();
	jq(document).ready(function(){ setLangFile('en-GB'); browserSupport(); });
</script>
<script type="text/javascript">function OptanonWrapper(){}</script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-59M58H58VM"></script>
<script>
	//Google Tag Code
	window.dataLayer = window.dataLayer || []; 
	function gtag(){ dataLayer.push(arguments); } 
	gtag('js', new Date()); gtag('config', 'G-59M58H58VM'); 
	
	//Google Analytics Code
	googleEventTrack('Eos-4-27-2f');
	(function(i,s,o,g,r,a,m){ i['GoogleAnalyticsObject']=r; i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)}, i[r].l=1*new Date(); a=s.createElement(o), m=s.getElementsByTagName(o)[0]; a.async=1; a.src=g; m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create','UA-11521293-2','auto'); ga('require','linkid','linkid.js');
	ga('set','anonymizeIp',true); ga('send','pageview');

	//HubSpot Analytics Code
	(function(d,s,i,r) { if(d.getElementById(i)){return;} var n=d.createElement(s), e=d.getElementsByTagName(s)[0]; n.id=i; n.src='https://js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/691113.js'; e.parentNode.insertBefore(n, e); })(document,"script","hs-analytics",300000);
</script>
</head>
<body id="pgEos4272f" class="com-content view-article lg-engb">
<div id="bodyContainer">
	</header>
	<!-- /headerContainer -->

		<div  id="bannerContainer">
		<div id="bannerSlider">
						<!-- /topSubMenu -->

						
<ul class="bannerWrap autoplay staticWrap">
				<li  style="background-image:url(/assets/images/banner/default/banner_inner_bg.jpg);" >
				<div class="slider-item slider-fw">
												<h1 class="main-head">EOS 4.27.2F TOI</h1>
										</div>
		</li>
		</ul>
<!-- /sliderWrap -->

					</div>
		<!-- /bannerSlider -->

	<!-- /bannerContainer -->
		<div id="dataContainer">
				<div id="dataContainerBg">&nbsp;</div>
				<div id="dataArea">
			<div class="dataTabBg">&nbsp;</div>
			<div  id="dataWrap">
				<div class="dataTabBg">&nbsp;</div>
								<!-- /position-left -->

				<main id="contentWrap" role="main">
										<div id="system-message-container">
	</div>

										
					<div class="item-page">
    
    
    <div class="page-header">
        <h2 class="pageTitle"> Policy Debugging CLI            
            
            <span class="pdf-icon headLink"><a href="/en/support/toi/eos-4-27-2f/15100-policy-debugging-cli?tmpl=component&amp;format=pdf" onclick="" target="_blank" title="PDF" rel="nofollow"> <span class="icon-book ico24-pdf"></span> PDF</a></span>
          </h2>
        
        
        
      </div>
    
    
    <div class="article-info muted">
    <dl class="article-info">
            
            <dd class="createdby"><span class="icomoon-user"></span> 
        Written by <a href="/en/support/toi/author/330-davidcronin" >David Cronin</a>      </dd>
            
            <dd class="published"> 
        <span class="icomoon-calendar"></span> Posted on March 3, 2022 
      </dd>
            
            
            
            <dd class="modified"> 
        <span class="icomoon-calendar"></span> Updated on July 13, 2023 
      </dd>
            
            
            <dd class="hits"> 
        <span class="icomoon-eye-open"></span> 4776 Views </dd>
          </dl>
  </div>
    
  	<div id="tagsBar">
		    <span class="tag-22 tag-list0" itemprop="keywords">
            <a href="/en/support/toi/tag/routing">Routing</a>
          </span>
		    <span class="tag-33 tag-list1" itemprop="keywords">
            <a href="/en/support/toi/tag/bgp">BGP</a>
          </span>
		    <span class="tag-760 tag-list2" itemprop="keywords">
            <a href="/en/support/toi/tag/rcf">RCF</a>
          </span>
		    <span class="tag-929 tag-list3" itemprop="keywords">
            <a href="/en/support/toi/tag/eos-4-27-2f"> EOS 4.27.2F</a>
          </span>
		    <span class="tag-965 tag-list4" itemprop="keywords">
            <a href="/en/support/toi/tag/eos-4-28-1f">EOS 4.28.1F</a>
          </span>
		    <span class="tag-1034 tag-list5" itemprop="keywords">
            <a href="/en/support/toi/tag/eos-4-29-1f">EOS 4.29.1F</a>
          </span>
		    <span class="tag-1090 tag-list6" itemprop="keywords">
            <a href="/en/support/toi/tag/eos-4-30-1f">EOS 4.30.1F</a>
          </span>
			</div>
  
                        <div id="tocWrap">
    <h5>Table of Content <span id="tocSH">Hide</span></h5>
    <ul id="tocList">
      <li>
        </li>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#description">Description</a>
<ul>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#platform-compatibility">Platform compatibility</a></li>
</ul>
</li>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#feature-history">Feature History</a>
<ul>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#configuration">Configuration</a></li>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#show-commands">Show Commands</a></li>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#example-output">Example Output</a></li>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#troubleshooting">Troubleshooting</a></li>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#tracing">Tracing</a></li>
<li>-- <a href="https://pmathy1.github.io/rcf-toi/policy-debugging-cli.html#limitations">Limitations</a></li>
    </ul>
  </div>
  <!-- /tocWrap -->
  <article id="toiContent">
<h2><span id="description">Description</span></h2>
<p>This document describes a new CLI command to help debug how and why policy permits and denies paths. The aim of this CLI command is for the user to debug a route map or RCF (Routing Control Functions) function by specifying as input a prefix for which BGP has reachability for, either via a BGP peer or a redistribute source. The path information for this prefix is then used in the evaluation of a route map or RCF function. The route map or RCF function can be specified by the user, but if none is specified the route map or RCF function applied at the point of application is used. Any route map or RCF function configured can be specified, even if it has not been applied to a point of application.</p>
<p>The output is to help users understand the flow of the route map or RCF function as it is evaluated against a specified path.</p>
<p>For route maps output will contain the sequences that were evaluated in the route map. Within each there will be information about the result of match clause evaluation, sub route map evaluation, set clauses that were applied to the path in this sequence, whether a continue statement was invoked in the sequence, and ultimately the result of the sequence on whether the path was permitted or denied.</p>
<p>For RCF a textual representation explaining the control flow of a given evaluation of an RCF function is presented.</p>
<h3><span id="platform-compatibility">Platform compatibility</span></h3>
<p>Multi Agent, Platform independent.</p>
<h2><span id="feature-history">Feature History</span></h2>
<table class="data-table">
<tbody>
<tr>
<th>Release</th>
<th>Update</th>
</tr>
<tr>
<td>4.22.1F</td>
<td>Initial introduction Support for inbound point of application</td>
</tr>
<tr>
<td>4.23.1F</td>
<td>Support for outbound point of application</td>
</tr>
<tr>
<td>4.25.2F</td>
<td>Support for redistribute point of application</td>
</tr>
<tr>
<td>4.27.2F</td>
<td>Support for RCF on IPv4/IPv6 Unicast inbound point of application</td>
</tr>
<tr>
<td>4.28.1F</td>
<td>Support for RCF on redistribute point of application </td>
</tr>
<tr>
<td>4.29.1F</td>
<td>Support for RCF on IPv4/IPv6 Unicast outbound point of application</td>
</tr>
<tr>
<td>4.29.2F</td>
<td>Support for RCF on EVPN inbound and outbound point of application</td>
</tr>
<tr>
<td>4.30.0F</td>
<td>Support for RCF on MPLS L3 VPN IPv4/IPv6 inbound and outbound point of application</td>
</tr>
<tr>
<td>4.30.0F</td>
<td>Support for RCF on MPLS L3 VPN and L3 EVPN import point of application</td>
</tr>
<tr>
<td>4.30.1F</td>
<td>Support for RCF on MPLS L3 VPN and L3 EVPN export point of application</td>
</tr>
</tbody>
</table>
<h3><span id="configuration">Configuration</span></h3>
<p>None.</p>
<h3><span id="show-commands">Show Commands</span></h3>
<pre>show bgp debug policy inbound neighbor ( &lt;neighbor address&gt; | all ) ( ipv4 | ipv6 ) unicast [ vrf &lt;vrf name&gt; ] [ route-map &lt;route-map&gt; | rcf &lt;function name&gt;() ] &lt;prefix&gt; 

show bgp debug policy outbound neighbor &lt;neighbor address&gt; ( ipv4 | ipv6 ) unicast [ vrf &lt;vrf name&gt; ] [ route-map &lt;route-map&gt; | rcf &lt;function name&gt;() ] &lt;prefix&gt;

show bgp debug policy redistribute ( ipv4 | ipv6 ) unicast [ vrf &lt;vrf name&gt; ] [ route-map &lt;route-map&gt; | rcf &lt;function name&gt;() ] &lt;prefix&gt;

show bgp debug policy ( inbound | outbound ) neighbor ( &lt;neighbor address&gt; | all ) evpn [ rcf &lt;function name&gt;() ] route-type ip-prefix &lt;prefix&gt; rd &lt;rd&gt;

show bgp debug policy ( inbound | outbound ) neighbor ( &lt;neighbor address&gt; | all ) ( vpn-ipv4 | vpn-ipv6 ) [ rcf &lt;function name&gt;() ] &lt;prefix&gt; rd &lt;rd&gt;

show bgp debug policy import ( vpn-route filter-rcf ( vpn-ipv4 | vpn-ipv6 ) | ( ipv4 unicast | ipv6 unicast ) ) [ vrf &lt;vrf name&gt;] [ rcf &lt;function name&gt;() ] &lt;prefix&gt; rd &lt;rd&gt;

show bgp debug policy export ( vrf-route filter-rcf ( ipv4 unicast | ipv6 unicast ) | ( evpn | vpn-ipv4 | vpn-ipv6 ) ) [ vrf &lt;vrf name&gt;] [ rcf &lt;function name&gt;() ] &lt;prefix&gt;</pre>
<h3><span id="example-output">Example Output</span></h3>
<pre>% show bgp debug policy inbound neighbor all ipv4 unicast 0.0.0.0/0 

Path with NLRI 0.0.0.0/0, received from 192.168.0.1

route-map foo
 seq 10 permit
     match as 1 (failed)
     Seq result: fall through to next sequence
  seq 20 permit
     match as 1 (matched)
     sub-route-map sub_foo (permit)
        seq 10 permit
           match as 1 (matched)
           Seq result: permit
        Route map result: permit, matching sequence 10
     Seq result: permit
  Route map result: permit, matching sequence 20


Path with NLRI 0.0.0.0/0, received from 192.168.0.2

The path was allowed by the evaluation of INBOUND_POLICY().

code unit DEBUG
1 function INBOUND_POLICY() {
     --------
2    med = 10;
     T----- T---
3    return true;
</pre>
<h3><span id="troubleshooting">Troubleshooting</span></h3>
<p>The following errors can be printed to the CLI:</p>
<ul>
<li>Failed to find neighbor</li>
<ul>
<li>No established BGP neighbors were found in the VRF. This only occurs when debugging all neighbors.</li>
</ul>
<li>Failed to find neighbor &lt;neighbor address&gt;</li>
<ul>
<li>The specified neighbor is invalid.</li>
</ul>
<li>Failed to find VRF &lt;vrf name&gt;</li>
<ul>
<li>The specified VRF is invalid.</li>
</ul>
<li>Policy debug for all VRFs is not supported</li>
<ul>
<li>The command does not support debugging paths in all VRFs simultaneously.</li>
</ul>
<li>Failed to find route map &lt;route map name&gt;</li>
<ul>
<li>The specified route map is invalid.</li>
</ul>
<li>Failed to find RCF function &lt;function name&gt;</li>
<ul>
<li>The specified RCF function is invalid.</li>
</ul>
<li>Failed to find NLRI &lt;prefix&gt;</li>
<ul>
<li>This means that the specified peer(s) did not receive a path to this prefix, or it has since been withdrawn. Note the command does not support paths received via a peer that has negotiated add path. Therefore, a peer may have received a prefix but this error will be returned as it was received with add path.</li>
</ul>
<li>Neighbor &lt;neighbor address&gt; is not established</li>
<ul>
<li>A neighbor address has been specified and the given neighbor is not established.</li>
</ul>
<li>BGP best path will not be advertised back to its source neighbor &lt;neighbor address&gt;</li>
<ul>
<li>This error can occur when debugging a route map when applied to outbound policy. If the best path for a prefix is from the specified neighbor, we won’t advertise it back to that neighbor. This error reflects that behavior.</li>
</ul>
<li>Not supported</li>
<ul>
<li>The most likely reason for this error is because the system is not running in multi-agent mode, which is required.</li>
</ul>
<li>RCF is not supported for paths redistributed from &lt;protocol&gt;</li>
<ul>
<li>The command does not support specifying an RCF function on the protocol the path has been redistributed from.</li>
</ul>
<li>RCF compilation in progress</li>
<ul>
<li>The RCF configuration is currently being compiled by the RCF agent. Compilation must finish before an RCF function can be debugged.</li>
</ul>
<li>Failed to debug path with NLRI &lt;prefix&gt;</li>
<ul>
<li>The most likely reason for this error is the prefix passed to the command was denied by other configuration, such as a neighbor applied prefix list.</li>
</ul>
<li>Update to peer outbound configuration is in progress</li>
<ul>
<li>The most likely reason for this error is that outbound policy has recently been changed and has not taken effect in the update group yet.</li>
</ul>
<li>Debugging a route map is not supported for &lt;AFI SAFI&gt;</li>
<ul>
<li>This error can occur when the specified neighbor has a route map applied at the point of application and the show command does not support debugging a route map for the specified AFI SAFI. See Limitations section below.</li>
</ul>
</ul>
<h3><span id="tracing">Tracing</span></h3>
<p>Enable PolicyDebug tracing in the BGP agent. This will provide insight into errors that occur when the command is invoked.</p>
<p><code>trace Bgp enable PolicyDebug all</code></p>
<h3><span id="limitations">Limitations</span></h3>
<ul>
<li>The command only works in Multi Agent mode.</li>
<li>Paths transmitted with add path are not selectable with the command.</li>
<li>Set clauses not applied to BGP paths or not supported in Multi Agent mode, but are present in the config for sequences that would apply set clauses to the path, are present in the output of this command, even though they are not applied.</li>
<li>Interface values may not be available during the evaluation when a route map, or RCF function, is specified. Applying the route map, or RCF function, to the neighbor and then running the debug command will result in interface values being available.</li>
<li>Debugging a route map is only supported for IPv4 Unicast and IPv6 Unicast AFI SAFIs.</li>
</ul>
    
    
         
</div>

					<div class="clearfix"></div>
					
				</main>
				<!-- /contentWrap -->
			</div>
			<!-- /dataWrap -->
			
		</div>
		<!-- /dataArea -->
	</div>
	<!-- /dataContainer -->

</div>
<!-- /bodyContainer -->
<script type="text/javascript" src="https://customer.cludo.com/scripts/bundles/search-script.min.js"></script>
<script>
	var CludoSearch;
	(function(){var cludoSettings = {customerId: 2013, engineId: '9664', searchUrl: 'https://www.arista.com/en/search-results/', language: 'en', searchInputs: ['cludo-search'], type: 'inline', disableAutocomplete: true, hideSearchFilters: true, searchApiUrl: 'https://api-eu1.cludo.com/api/v3'}; CludoSearch= new Cludo(cludoSettings); CludoSearch.init(); })();
	var wifiId = "123036";
</script>
<div id="noSupportMsg" style="display:none;"></div>


</body>
</html>
